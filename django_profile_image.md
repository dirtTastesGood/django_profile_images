# Profile Images in Django

## Custom User Model

Link to tutorial for extending user model

## PIL

    import PIL


## Create ProfileImage Model
Define `get_upload_path`
    
    from users_app import CustomUserModel
    # or from django.contrib.auth import get_user_model

    def get_upload_path(instance, filename):

        extension = filename.split('.')[-1]

        upload_path = path.join(f"profile_images/{instance.email}/", f'profile_image.{extension}')
        return upload_path

    class ProfileImage(models.Model):

        owner = models.ForeignKey(CustomUserModel, on_delete='models.CASCADE', related_name='profile_image')

        image = models.ImageField(
            _("profile image"),
            default="profile_images/default.jpg",
            upload_to=get_upload_path,
        )

        def __str__(self):
            return self.image

### ProfileImage Form

    from users.models import ProfileImage

    class ProfileImageUpdateForm(forms.ModelForm):

        class Meta:
            model = ProfileImage
            fields = ['image']

### Template

Break this down into steps:

    <!-- enctype="multipart/form-data" is
    required to be able to upload the file -->
    <form method="POST" enctype="multipart/form-data"> 
        {% csrf_token %}

        <!-- The field label will be styled and used
        as the button to bring up the file select menu.
        An input field with an id of 'id_image' will
        be generated by the Django form rendering -->
        <label for="id_image">
            <p>
                Select profile image
            </p> 

            <!-- This is the original field and will
            be hidden because it looks gross and is
            difficult to customize -->
            <div id="profile-image-field">
                <!-- This will generate the input
                field with an id of 'id_image'-->
                {{ u_form.image }}
            </div>
        </label>

        <!-- Updated with JS to display the name of the file the user selects, if desired. -->
        <div id="new-image">
            No file selected
        </div>

        <!-- Button to submit the form -->
        <button type="submit">
            Update
        </button>
    </form>

